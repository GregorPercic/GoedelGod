module goedel-god where
open import Agda.Primitive
open import logic

postulate
    ğ• : Set
    ğ•€ : Set
    _ğ•£_ : ğ• â†’ ğ• â†’ Set

infixl 80 _ğ•£_

private variable
    l k : Level

Ïƒ : âˆ€ l â†’ Set (lsuc l)
Ïƒ l = ğ• â†’ Set l

postulate
    P : (ğ•€ â†’ Ïƒ l) â†’ Ïƒ l

infixr 70 mÂ¬_
mÂ¬_ : Ïƒ l â†’ Ïƒ l
mÂ¬_ Ï† = Î» w â†’ Â¬ (Ï† w)

infixl 65 _mâˆ§_
_mâˆ§_ : Ïƒ l â†’ Ïƒ k â†’ Ïƒ _
Ï† mâˆ§ Ïˆ = Î» w â†’ Ï† w âˆ§ Ïˆ w

infixl 60 _mâˆ¨_
_mâˆ¨_ : Ïƒ l â†’ Ïƒ k â†’ Ïƒ _
Ï† mâˆ¨ Ïˆ = Î» w â†’ Ï† w âˆ¨ Ïˆ w

infixr 55 _mâ†’_
_mâ†’_ : Ïƒ l â†’ Ïƒ k â†’ Ïƒ _
Ï† mâ†’ Ïˆ = Î» w â†’ Ï† w â‡’ Ïˆ w

infixr 45 mâˆ€_
mâˆ€_ : âˆ€ {A : Set k} â†’ (A â†’ Ïƒ l) â†’ Ïƒ _ -- (l âŠ” k)
mâˆ€_ Î¦ = Î» w â†’ âˆ€ x â†’ Î¦ x w

infixr 45 mâˆƒ_
mâˆƒ_ : âˆ€ {A : Set k} â†’ (A â†’ Ïƒ l) â†’ Ïƒ _
mâˆƒ_ Î¦ = Î» w â†’ âˆƒ[ x âˆˆ _ ] Î¦ x w

-- both have precedence 20
â–¡ : Ïƒ l â†’ Ïƒ l
â–¡ Ï† = Î» w â†’ (v : ğ•) â†’ w ğ•£ v â†’ Ï† v

â—‡ : Ïƒ l â†’ Ïƒ l
â—‡ Ï† = Î» w â†’ âˆƒ[ v âˆˆ ğ• ] (w ğ•£ v âˆ§ Ï† v)

âŸ¦_âŸ§ : Ïƒ l â†’ Set l
âŸ¦ Ï† âŸ§ = (w : ğ•) â†’ Ï† w

postulate
    A1a : âŸ¦ mâˆ€ (Î» (Î¦ : ğ•€ â†’ Ïƒ l) â†’ P (Î» x â†’ mÂ¬ (Î¦ x)) mâ†’ mÂ¬ (P Î¦)) âŸ§
    A1b : âŸ¦ mâˆ€ (Î» (Î¦ : ğ•€ â†’ Ïƒ l) â†’ mÂ¬ (P Î¦) mâ†’ P (Î» x â†’ mÂ¬ (Î¦ x))) âŸ§
    A2 : âŸ¦ mâˆ€ (Î» (Î¦ : ğ•€ â†’ Ïƒ l) â†’ mâˆ€ (Î» (Î¨ : ğ•€ â†’ Ïƒ k) â†’ (â–¡ (mâˆ€ (Î» x â†’ Î¦ x mâ†’ Î¨ x)) mâˆ§ P Î¦) mâ†’ P Î¨)) âŸ§

T1 : âŸ¦ mâˆ€ (Î» (Î¦ : ğ•€ â†’ Ïƒ l) â†’ P Î¦ mâ†’ â—‡ (mâˆƒ Î¦)) âŸ§
T1 w Î¦ with LEM ((â—‡ (mâˆƒ Î¦)) w) | LEM (P Î¦ w)
... | injâ‚ yes | _ = injâ‚‚ yes
... | _ | injâ‚‚ no  = injâ‚ no
... | injâ‚‚ Â¬â—‡âˆƒÎ¦ | injâ‚ PÎ¦w = {!   !}

G : âˆ€ l â†’ ğ•€ â†’ Ïƒ (lsuc l)
G l x = mâˆ€ (Î» Î¦ â†’ P Î¦ mâ†’ Î¦ x)

postulate
    A3 : âŸ¦ P (G l) âŸ§
    
C : âŸ¦ â—‡ (mâˆƒ (G l)) âŸ§
C = {!   !}

postulate
    A4 : âŸ¦ mâˆ€ (Î» (Î¦ : ğ•€ â†’ Ïƒ l) â†’ P Î¦ mâ†’ â–¡ (P Î¦)) âŸ§
    
infixr 80 _ess_
_ess_ : (ğ•€ â†’ Ïƒ l) â†’ ğ•€ â†’ Ïƒ (lsuc l)
_ess_ Î¦ x = Î¦ x mâˆ§ (mâˆ€ (Î» (Î¨ : ğ•€ â†’ Ïƒ _) â†’ Î¨ x mâ†’ â–¡ (mâˆ€ (Î» y â†’ Î¦ y mâ†’ Î¨ y))))

NE : âˆ€ l â†’ ğ•€ â†’ Ïƒ (lsuc l)
NE l x = mâˆ€ (Î» Î¦ â†’ Î¦ ess x mâ†’ â–¡ (mâˆƒ Î¦))

postulate
    A5 : âŸ¦ P (NE l) âŸ§
    
    symm : âˆ€ {x y} â†’ x ğ•£ y â†’ y ğ•£ x

T3 : âŸ¦ â–¡ (mâˆƒ (G l)) âŸ§
T3 = {!   !}

C2 : âŸ¦ mâˆƒ (G l) âŸ§
C2 = {!   !}

-- auxiliary
valid-to-nec-valid : âˆ€ {Î¦ : Ïƒ l} â†’ âŸ¦ Î¦ âŸ§ â†’ âŸ¦ â–¡ Î¦ âŸ§
valid-to-nec-valid valid-Î¦ w w' wğ•£w' = valid-Î¦ w'

infixl 10 _âŠ¨_ 
_âŠ¨_ : Ïƒ l â†’ Ïƒ k â†’ Set _
Î¦ âŠ¨ Î¨ = âˆ€ w â†’ Î¦ w â†’ Î¨ w

Â¬â—‡-to-â–¡Â¬ : {Î¦ : Ïƒ l} â†’ mÂ¬ (â—‡ Î¦) âŠ¨ â–¡ (mÂ¬ Î¦)
Â¬â—‡-to-â–¡Â¬ {Î¦ = Î¦} w Â¬â—‡Î¦w v = Â¬[Pâˆ§Â¬Q]â†’[Pâ†’Q] (lemma v)
    where
        lemma : âˆ€ v â†’ Â¬ ((w ğ•£ v) âˆ§ Î¦ v)
        lemma = Â¬âˆƒ-âˆ€Â¬ Â¬â—‡Î¦w
        
Â¬mâˆƒ-to-mâˆ€Â¬ : {Î¦ : ğ•€ â†’ Ïƒ l} â†’ mÂ¬ (mâˆƒ (Î» x â†’ Î¦ x)) âŠ¨ mâˆ€ (Î» x â†’ mÂ¬ Î¦ x)
Â¬mâˆƒ-to-mâˆ€Â¬ w Â¬âˆƒ x Î¦x = Â¬âˆƒ (exists x Î¦x)

â–¡âˆ€-weakening : {Î¦ : ğ•€ â†’ Ïƒ l} {Î¨ : ğ•€ â†’ Ïƒ k} â†’ â–¡ (mâˆ€ (Î» x â†’ Î¦ x)) âŠ¨ â–¡ (mâˆ€ (Î» x â†’ Î¨ x mâ†’ Î¦ x))
â–¡âˆ€-weakening w hyp w' wğ•£w' x = injâ‚‚ (hyp w' wğ•£w' x)

Â¬â—‡âˆƒ-to-â–¡âˆ€Â¬ : {Î¦ : ğ•€ â†’ Ïƒ l} â†’ mÂ¬ (â—‡ (mâˆƒ (Î» x â†’ Î¦ x))) âŠ¨ â–¡ (mâˆ€ (Î» x â†’ mÂ¬ Î¦ x))
Â¬â—‡âˆƒ-to-â–¡âˆ€Â¬ = {!   !}